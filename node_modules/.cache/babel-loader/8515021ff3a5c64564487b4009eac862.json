{"ast":null,"code":"import PDFDict from \"../objects/PDFDict\";\nimport PDFName from \"../objects/PDFName\";\nimport PDFStream from \"../objects/PDFStream\";\nimport PDFArray from \"../objects/PDFArray\";\nimport PDFRef from \"../objects/PDFRef\";\nimport PDFNumber from \"../objects/PDFNumber\";\nvar PDFAnnotation = /** @class */function () {\n  function PDFAnnotation(dict) {\n    this.dict = dict;\n  }\n  // This is technically required by the PDF spec\n  PDFAnnotation.prototype.Rect = function () {\n    return this.dict.lookup(PDFName.of('Rect'), PDFArray);\n  };\n  PDFAnnotation.prototype.AP = function () {\n    return this.dict.lookupMaybe(PDFName.of('AP'), PDFDict);\n  };\n  PDFAnnotation.prototype.F = function () {\n    var numberOrRef = this.dict.lookup(PDFName.of('F'));\n    return this.dict.context.lookupMaybe(numberOrRef, PDFNumber);\n  };\n  PDFAnnotation.prototype.getRectangle = function () {\n    var _a;\n    var Rect = this.Rect();\n    return (_a = Rect === null || Rect === void 0 ? void 0 : Rect.asRectangle()) !== null && _a !== void 0 ? _a : {\n      x: 0,\n      y: 0,\n      width: 0,\n      height: 0\n    };\n  };\n  PDFAnnotation.prototype.setRectangle = function (rect) {\n    var x = rect.x,\n      y = rect.y,\n      width = rect.width,\n      height = rect.height;\n    var Rect = this.dict.context.obj([x, y, x + width, y + height]);\n    this.dict.set(PDFName.of('Rect'), Rect);\n  };\n  PDFAnnotation.prototype.getAppearanceState = function () {\n    var AS = this.dict.lookup(PDFName.of('AS'));\n    if (AS instanceof PDFName) return AS;\n    return undefined;\n  };\n  PDFAnnotation.prototype.setAppearanceState = function (state) {\n    this.dict.set(PDFName.of('AS'), state);\n  };\n  PDFAnnotation.prototype.setAppearances = function (appearances) {\n    this.dict.set(PDFName.of('AP'), appearances);\n  };\n  PDFAnnotation.prototype.ensureAP = function () {\n    var AP = this.AP();\n    if (!AP) {\n      AP = this.dict.context.obj({});\n      this.dict.set(PDFName.of('AP'), AP);\n    }\n    return AP;\n  };\n  PDFAnnotation.prototype.getNormalAppearance = function () {\n    var AP = this.ensureAP();\n    var N = AP.get(PDFName.of('N'));\n    if (N instanceof PDFRef || N instanceof PDFDict) return N;\n    throw new Error(\"Unexpected N type: \" + (N === null || N === void 0 ? void 0 : N.constructor.name));\n  };\n  /** @param appearance A PDFDict or PDFStream (direct or ref) */\n  PDFAnnotation.prototype.setNormalAppearance = function (appearance) {\n    var AP = this.ensureAP();\n    AP.set(PDFName.of('N'), appearance);\n  };\n  /** @param appearance A PDFDict or PDFStream (direct or ref) */\n  PDFAnnotation.prototype.setRolloverAppearance = function (appearance) {\n    var AP = this.ensureAP();\n    AP.set(PDFName.of('R'), appearance);\n  };\n  /** @param appearance A PDFDict or PDFStream (direct or ref) */\n  PDFAnnotation.prototype.setDownAppearance = function (appearance) {\n    var AP = this.ensureAP();\n    AP.set(PDFName.of('D'), appearance);\n  };\n  PDFAnnotation.prototype.removeRolloverAppearance = function () {\n    var AP = this.AP();\n    AP === null || AP === void 0 ? void 0 : AP.delete(PDFName.of('R'));\n  };\n  PDFAnnotation.prototype.removeDownAppearance = function () {\n    var AP = this.AP();\n    AP === null || AP === void 0 ? void 0 : AP.delete(PDFName.of('D'));\n  };\n  PDFAnnotation.prototype.getAppearances = function () {\n    var AP = this.AP();\n    if (!AP) return undefined;\n    var N = AP.lookup(PDFName.of('N'), PDFDict, PDFStream);\n    var R = AP.lookupMaybe(PDFName.of('R'), PDFDict, PDFStream);\n    var D = AP.lookupMaybe(PDFName.of('D'), PDFDict, PDFStream);\n    return {\n      normal: N,\n      rollover: R,\n      down: D\n    };\n  };\n  PDFAnnotation.prototype.getFlags = function () {\n    var _a, _b;\n    return (_b = (_a = this.F()) === null || _a === void 0 ? void 0 : _a.asNumber()) !== null && _b !== void 0 ? _b : 0;\n  };\n  PDFAnnotation.prototype.setFlags = function (flags) {\n    this.dict.set(PDFName.of('F'), PDFNumber.of(flags));\n  };\n  PDFAnnotation.prototype.hasFlag = function (flag) {\n    var flags = this.getFlags();\n    return (flags & flag) !== 0;\n  };\n  PDFAnnotation.prototype.setFlag = function (flag) {\n    var flags = this.getFlags();\n    this.setFlags(flags | flag);\n  };\n  PDFAnnotation.prototype.clearFlag = function (flag) {\n    var flags = this.getFlags();\n    this.setFlags(flags & ~flag);\n  };\n  PDFAnnotation.prototype.setFlagTo = function (flag, enable) {\n    if (enable) this.setFlag(flag);else this.clearFlag(flag);\n  };\n  PDFAnnotation.fromDict = function (dict) {\n    return new PDFAnnotation(dict);\n  };\n  return PDFAnnotation;\n}();\nexport default PDFAnnotation;","map":{"version":3,"sources":["../../../src/core/annotation/PDFAnnotation.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import PDFDict from \"../objects/PDFDict\";\nimport PDFName from \"../objects/PDFName\";\nimport PDFStream from \"../objects/PDFStream\";\nimport PDFArray from \"../objects/PDFArray\";\nimport PDFRef from \"../objects/PDFRef\";\nimport PDFNumber from \"../objects/PDFNumber\";\nvar PDFAnnotation = /** @class */ (function () {\n    function PDFAnnotation(dict) {\n        this.dict = dict;\n    }\n    // This is technically required by the PDF spec\n    PDFAnnotation.prototype.Rect = function () {\n        return this.dict.lookup(PDFName.of('Rect'), PDFArray);\n    };\n    PDFAnnotation.prototype.AP = function () {\n        return this.dict.lookupMaybe(PDFName.of('AP'), PDFDict);\n    };\n    PDFAnnotation.prototype.F = function () {\n        var numberOrRef = this.dict.lookup(PDFName.of('F'));\n        return this.dict.context.lookupMaybe(numberOrRef, PDFNumber);\n    };\n    PDFAnnotation.prototype.getRectangle = function () {\n        var _a;\n        var Rect = this.Rect();\n        return (_a = Rect === null || Rect === void 0 ? void 0 : Rect.asRectangle()) !== null && _a !== void 0 ? _a : { x: 0, y: 0, width: 0, height: 0 };\n    };\n    PDFAnnotation.prototype.setRectangle = function (rect) {\n        var x = rect.x, y = rect.y, width = rect.width, height = rect.height;\n        var Rect = this.dict.context.obj([x, y, x + width, y + height]);\n        this.dict.set(PDFName.of('Rect'), Rect);\n    };\n    PDFAnnotation.prototype.getAppearanceState = function () {\n        var AS = this.dict.lookup(PDFName.of('AS'));\n        if (AS instanceof PDFName)\n            return AS;\n        return undefined;\n    };\n    PDFAnnotation.prototype.setAppearanceState = function (state) {\n        this.dict.set(PDFName.of('AS'), state);\n    };\n    PDFAnnotation.prototype.setAppearances = function (appearances) {\n        this.dict.set(PDFName.of('AP'), appearances);\n    };\n    PDFAnnotation.prototype.ensureAP = function () {\n        var AP = this.AP();\n        if (!AP) {\n            AP = this.dict.context.obj({});\n            this.dict.set(PDFName.of('AP'), AP);\n        }\n        return AP;\n    };\n    PDFAnnotation.prototype.getNormalAppearance = function () {\n        var AP = this.ensureAP();\n        var N = AP.get(PDFName.of('N'));\n        if (N instanceof PDFRef || N instanceof PDFDict)\n            return N;\n        throw new Error(\"Unexpected N type: \" + (N === null || N === void 0 ? void 0 : N.constructor.name));\n    };\n    /** @param appearance A PDFDict or PDFStream (direct or ref) */\n    PDFAnnotation.prototype.setNormalAppearance = function (appearance) {\n        var AP = this.ensureAP();\n        AP.set(PDFName.of('N'), appearance);\n    };\n    /** @param appearance A PDFDict or PDFStream (direct or ref) */\n    PDFAnnotation.prototype.setRolloverAppearance = function (appearance) {\n        var AP = this.ensureAP();\n        AP.set(PDFName.of('R'), appearance);\n    };\n    /** @param appearance A PDFDict or PDFStream (direct or ref) */\n    PDFAnnotation.prototype.setDownAppearance = function (appearance) {\n        var AP = this.ensureAP();\n        AP.set(PDFName.of('D'), appearance);\n    };\n    PDFAnnotation.prototype.removeRolloverAppearance = function () {\n        var AP = this.AP();\n        AP === null || AP === void 0 ? void 0 : AP.delete(PDFName.of('R'));\n    };\n    PDFAnnotation.prototype.removeDownAppearance = function () {\n        var AP = this.AP();\n        AP === null || AP === void 0 ? void 0 : AP.delete(PDFName.of('D'));\n    };\n    PDFAnnotation.prototype.getAppearances = function () {\n        var AP = this.AP();\n        if (!AP)\n            return undefined;\n        var N = AP.lookup(PDFName.of('N'), PDFDict, PDFStream);\n        var R = AP.lookupMaybe(PDFName.of('R'), PDFDict, PDFStream);\n        var D = AP.lookupMaybe(PDFName.of('D'), PDFDict, PDFStream);\n        return { normal: N, rollover: R, down: D };\n    };\n    PDFAnnotation.prototype.getFlags = function () {\n        var _a, _b;\n        return (_b = (_a = this.F()) === null || _a === void 0 ? void 0 : _a.asNumber()) !== null && _b !== void 0 ? _b : 0;\n    };\n    PDFAnnotation.prototype.setFlags = function (flags) {\n        this.dict.set(PDFName.of('F'), PDFNumber.of(flags));\n    };\n    PDFAnnotation.prototype.hasFlag = function (flag) {\n        var flags = this.getFlags();\n        return (flags & flag) !== 0;\n    };\n    PDFAnnotation.prototype.setFlag = function (flag) {\n        var flags = this.getFlags();\n        this.setFlags(flags | flag);\n    };\n    PDFAnnotation.prototype.clearFlag = function (flag) {\n        var flags = this.getFlags();\n        this.setFlags(flags & ~flag);\n    };\n    PDFAnnotation.prototype.setFlagTo = function (flag, enable) {\n        if (enable)\n            this.setFlag(flag);\n        else\n            this.clearFlag(flag);\n    };\n    PDFAnnotation.fromDict = function (dict) { return new PDFAnnotation(dict); };\n    return PDFAnnotation;\n}());\nexport default PDFAnnotation;\n//# sourceMappingURL=PDFAnnotation.js.map"]},"metadata":{},"sourceType":"module"}