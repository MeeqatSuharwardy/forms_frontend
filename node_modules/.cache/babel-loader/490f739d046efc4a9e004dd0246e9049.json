{"ast":null,"code":"import { __extends } from \"tslib\";\nimport PDFName from \"../objects/PDFName\";\nimport PDFNumber from \"../objects/PDFNumber\";\nimport PDFFlateStream from \"./PDFFlateStream\";\nimport CharCodes from \"../syntax/CharCodes\";\nimport { copyStringIntoBuffer, last } from \"../../utils\";\nvar PDFObjectStream = /** @class */function (_super) {\n  __extends(PDFObjectStream, _super);\n  function PDFObjectStream(context, objects, encode) {\n    if (encode === void 0) {\n      encode = true;\n    }\n    var _this = _super.call(this, context.obj({}), encode) || this;\n    _this.objects = objects;\n    _this.offsets = _this.computeObjectOffsets();\n    _this.offsetsString = _this.computeOffsetsString();\n    _this.dict.set(PDFName.of('Type'), PDFName.of('ObjStm'));\n    _this.dict.set(PDFName.of('N'), PDFNumber.of(_this.objects.length));\n    _this.dict.set(PDFName.of('First'), PDFNumber.of(_this.offsetsString.length));\n    return _this;\n  }\n  PDFObjectStream.prototype.getObjectsCount = function () {\n    return this.objects.length;\n  };\n  PDFObjectStream.prototype.clone = function (context) {\n    return PDFObjectStream.withContextAndObjects(context || this.dict.context, this.objects.slice(), this.encode);\n  };\n  PDFObjectStream.prototype.getContentsString = function () {\n    var value = this.offsetsString;\n    for (var idx = 0, len = this.objects.length; idx < len; idx++) {\n      var _a = this.objects[idx],\n        object = _a[1];\n      value += object + \"\\n\";\n    }\n    return value;\n  };\n  PDFObjectStream.prototype.getUnencodedContents = function () {\n    var buffer = new Uint8Array(this.getUnencodedContentsSize());\n    var offset = copyStringIntoBuffer(this.offsetsString, buffer, 0);\n    for (var idx = 0, len = this.objects.length; idx < len; idx++) {\n      var _a = this.objects[idx],\n        object = _a[1];\n      offset += object.copyBytesInto(buffer, offset);\n      buffer[offset++] = CharCodes.Newline;\n    }\n    return buffer;\n  };\n  PDFObjectStream.prototype.getUnencodedContentsSize = function () {\n    return this.offsetsString.length + last(this.offsets)[1] + last(this.objects)[1].sizeInBytes() + 1;\n  };\n  PDFObjectStream.prototype.computeOffsetsString = function () {\n    var offsetsString = '';\n    for (var idx = 0, len = this.offsets.length; idx < len; idx++) {\n      var _a = this.offsets[idx],\n        objectNumber = _a[0],\n        offset = _a[1];\n      offsetsString += objectNumber + \" \" + offset + \" \";\n    }\n    return offsetsString;\n  };\n  PDFObjectStream.prototype.computeObjectOffsets = function () {\n    var offset = 0;\n    var offsets = new Array(this.objects.length);\n    for (var idx = 0, len = this.objects.length; idx < len; idx++) {\n      var _a = this.objects[idx],\n        ref = _a[0],\n        object = _a[1];\n      offsets[idx] = [ref.objectNumber, offset];\n      offset += object.sizeInBytes() + 1; // '\\n'\n    }\n    return offsets;\n  };\n  PDFObjectStream.withContextAndObjects = function (context, objects, encode) {\n    if (encode === void 0) {\n      encode = true;\n    }\n    return new PDFObjectStream(context, objects, encode);\n  };\n  return PDFObjectStream;\n}(PDFFlateStream);\nexport default PDFObjectStream;","map":{"version":3,"sources":["../../../src/core/structures/PDFObjectStream.ts"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["import { __extends } from \"tslib\";\nimport PDFName from \"../objects/PDFName\";\nimport PDFNumber from \"../objects/PDFNumber\";\nimport PDFFlateStream from \"./PDFFlateStream\";\nimport CharCodes from \"../syntax/CharCodes\";\nimport { copyStringIntoBuffer, last } from \"../../utils\";\nvar PDFObjectStream = /** @class */ (function (_super) {\n    __extends(PDFObjectStream, _super);\n    function PDFObjectStream(context, objects, encode) {\n        if (encode === void 0) { encode = true; }\n        var _this = _super.call(this, context.obj({}), encode) || this;\n        _this.objects = objects;\n        _this.offsets = _this.computeObjectOffsets();\n        _this.offsetsString = _this.computeOffsetsString();\n        _this.dict.set(PDFName.of('Type'), PDFName.of('ObjStm'));\n        _this.dict.set(PDFName.of('N'), PDFNumber.of(_this.objects.length));\n        _this.dict.set(PDFName.of('First'), PDFNumber.of(_this.offsetsString.length));\n        return _this;\n    }\n    PDFObjectStream.prototype.getObjectsCount = function () {\n        return this.objects.length;\n    };\n    PDFObjectStream.prototype.clone = function (context) {\n        return PDFObjectStream.withContextAndObjects(context || this.dict.context, this.objects.slice(), this.encode);\n    };\n    PDFObjectStream.prototype.getContentsString = function () {\n        var value = this.offsetsString;\n        for (var idx = 0, len = this.objects.length; idx < len; idx++) {\n            var _a = this.objects[idx], object = _a[1];\n            value += object + \"\\n\";\n        }\n        return value;\n    };\n    PDFObjectStream.prototype.getUnencodedContents = function () {\n        var buffer = new Uint8Array(this.getUnencodedContentsSize());\n        var offset = copyStringIntoBuffer(this.offsetsString, buffer, 0);\n        for (var idx = 0, len = this.objects.length; idx < len; idx++) {\n            var _a = this.objects[idx], object = _a[1];\n            offset += object.copyBytesInto(buffer, offset);\n            buffer[offset++] = CharCodes.Newline;\n        }\n        return buffer;\n    };\n    PDFObjectStream.prototype.getUnencodedContentsSize = function () {\n        return (this.offsetsString.length +\n            last(this.offsets)[1] +\n            last(this.objects)[1].sizeInBytes() +\n            1);\n    };\n    PDFObjectStream.prototype.computeOffsetsString = function () {\n        var offsetsString = '';\n        for (var idx = 0, len = this.offsets.length; idx < len; idx++) {\n            var _a = this.offsets[idx], objectNumber = _a[0], offset = _a[1];\n            offsetsString += objectNumber + \" \" + offset + \" \";\n        }\n        return offsetsString;\n    };\n    PDFObjectStream.prototype.computeObjectOffsets = function () {\n        var offset = 0;\n        var offsets = new Array(this.objects.length);\n        for (var idx = 0, len = this.objects.length; idx < len; idx++) {\n            var _a = this.objects[idx], ref = _a[0], object = _a[1];\n            offsets[idx] = [ref.objectNumber, offset];\n            offset += object.sizeInBytes() + 1; // '\\n'\n        }\n        return offsets;\n    };\n    PDFObjectStream.withContextAndObjects = function (context, objects, encode) {\n        if (encode === void 0) { encode = true; }\n        return new PDFObjectStream(context, objects, encode);\n    };\n    return PDFObjectStream;\n}(PDFFlateStream));\nexport default PDFObjectStream;\n//# sourceMappingURL=PDFObjectStream.js.map"]},"metadata":{},"sourceType":"module"}